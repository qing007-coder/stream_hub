# 🚀 分布式短视频平台 (Tiktok-Clone) 功能需求文档

## 一、 核心业务模块 (Core Services)

### 1. 视频与内容流 (Video & Feed)
* **视频发布链路**：
    * **上传与存储**：支持大文件上传至 **MinIO** 对象存储。
    * **#话题标签**：发布描述支持 `#关键词` 自动识别，建立视频与话题的关联索引。
    * **异步转码抽帧**：
        * 集成 **FFmpeg**。
        * 上传后通过 **Kafka** 异步触发：自动截取封面图 + 视频转码（H.264 标准化）。
* **信息流 (Feed)**：
    * **游标分页 (Cursor Pagination)**：基于 `latest_time` 时间戳拉取，防止重复刷新。
    * **双流模型**：
        * **推荐流**：根据用户偏好算法下发（Recommend Service）。
        * **关注流**：拉取已关注博主的最新动态。

### 2. 高并发互动 (Interaction)
* **点赞系统**：
    * **性能优化**：Redis 存储点赞状态与计数，Kafka 异步同步至 MySQL。
* **评论系统**：
    * **层级结构**：支持二级评论（父子评论）。
    * **排序策略**：支持按时间或热度（点赞数）排序。
* **社交关系**：关注/粉丝体系，支持互粉状态查询。

### 3. 用户与鉴权 (User & Auth)
* **账号体系**：手机号/用户名注册登录。
* **鉴权安全**：基于 **JWT** 的无状态鉴权，支持 Gateway 层统一拦截校验。

---

## 二、 扩展与进阶模块 (Advanced Features)

### 1. 消息与即时通讯 (IM)
* **私信系统**：基于 **WebSocket** 实现实时一对一聊天。
* **通知中心**：点赞、评论、关注等动作触发实时红点/系统通知。

### 2. 开放平台 (Open Platform)
* **三方接入**：提供开放 API，允许开发者获取博主的基础公开数据（粉丝数、作品数）。
* **数据看板**：面向创作者的后台，展示视频播放趋势、转码状态。

### 3. 直播系统 (Live Stream - 规划中)
* **流媒体处理**：支持 RTMP 推流，HLS/HTTP-FLV 拉流观看。
* **直播互动**：直播间实时弹幕。

---

## 三、 数据分析与推荐 (Data & AI)

* **行为埋点**：用户点击、点赞、完播率等数据异步写入 **ClickHouse**。
* **推荐引擎**：
    * **热度算法**：基于 Newton's Law of Cooling（牛顿冷却定律）计算 24h 热门榜单。
    * **简单协同过滤**：Python 离线计算用户特征并下发推荐列表。

---

## 四、 技术栈概览 (Tech Stack)

| 类别 | 技术选型 |
| :--- | :--- |
| **后端框架** | Go (Gin, gRPC) |
| **数据库** | MySQL 8.0 (元数据), ClickHouse (埋点) |
| **缓存/中间件** | Redis, Kafka, ZooKeeper/Etcd |
| **存储/工具** | MinIO (对象存储), FFmpeg (多媒体处理) |
| **运维监控** | Prometheus, Grafana, Jaeger (链路追踪) |